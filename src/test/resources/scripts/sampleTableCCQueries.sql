SELECT stationid ,avg(tmax) AS avgTemp,absolute_error(avgTemp),relative_error(avgTemp) FROM climatechange_view GROUP BY stationid ORDER BY stationid ASC limit 10 WITH error;
SELECT COUNT(data_value) AS no_of_days,absolute_error(no_of_days),relative_error(no_of_days),CAST(substr(ymd,0,4) AS INT) AS YEAR,id AS station_id FROM CLIMATECHANGE WHERE ELEMENT = 'TMAX' AND data_value > 100  GROUP BY year,id ORDER BY no_of_days desc limit 50 WITH error;
SELECT COUNT(data_value) AS no_of_days,absolute_error(no_of_days),relative_error(no_of_days),id AS station_id FROM (SELECT data_value,id,CAST(substr(ymd,0,4) AS INT) AS YEAR FROM CLIMATECHANGE WHERE ELEMENT = 'TMAX' AND data_value > 100 ) WHERE YEAR =2004 AND id='MXN00003002' group by id order by no_of_days desc with error;
select count(*) ,count(*) sample_ from (SELECT IF( ELEMENT='TMAX', data_value, NULL ) AS tmax,IF( ELEMENT='TMIN', data_value, NULL ) AS tmin,CAST(substr(ymd, 0, 4) AS INT) AS year FROM CLIMATECHANGE WHERE ELEMENT IN ('TMIN','TMAX')) with error;
select count(*) ,count(*) sample_ from climateChange_View with error;
select round(v2, 2) , x, y from ( SELECT element, avg(CAST(data_value AS real)/10) AS v2 ,absolute_error(v2) as x ,relative_error(v2) as y FROM (SELECT * FROM climateChange WHERE CAST(substr(ymd,0,4) as int) >= 1763) WHERE element IN ('TMIN', 'TMAX', 'PRCP') GROUP BY element ORDER BY v1) WITH error;
